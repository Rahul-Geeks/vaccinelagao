<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unsubscribe</title>
</head>

<body>
    <h3 id="unsubscribe">Unsubscribing...</h3>

    <script>
        let url = new URL(window.location.href);
        let email = url.searchParams.get("email"), hash = url.searchParams.get("hash");

        console.log(url);
        if (email && hash) {
            let params = {
                method: 'DELETE',
                headers: { 'Content-type': "application/json" },
                body: JSON.stringify({ email: email, hash: hash })
            };
            fetch('/unsubscribe', params)
                .then(response => {
                    if (response.ok)
                        document.getElementById("unsubscribe").innerText = "Unsubscribed ðŸ‘ "
                }).catch(error => console.log("Failure"));
        } else
            console.log("Fields not found");
    </script>
</body>

</html>